# Техническая спецификация: SPA "Навигатор здоровья" (Pure Vanilla JS)

## 1. Общее описание
Система для самодиагностики здоровья, ориентированная на профессионалов индустрии красоты (40+), работающих физически. Приложение собирает данные через тест, анализирует состояние и выдает персональные рекомендации.

## 2. Технологический стек
- **Runtime:** Browser (Chrome, Safari, Firefox mobile)
- **Logic:** Vanilla JavaScript (ES6+)
- **Styling:** Custom CSS3 (Flexbox, Mobile-first)
- **Data:** JSON (локальные файлы)
- **QR Generation:** Библиотека `qrcode` (рендер в тег <img> через DataURI)

## 3. Файловая структура
/
├── survey.html          # Точка входа
├── survey.css           # Mobile-first стили
├── survey-app.js              # Ядро: роутинг, стейт, логика
├---distributors.json # Конфиг дистрибьюторов (ключ - origin)
│── data.json         # Вопросы и база рекомендаций
└── assets/             # Иконки и сторонние библиотеки

## 4. Архитектура данных

### 4.1. Контекст дистрибьютора
Приложение считывает `window.location.origin` и сопоставляет его с ключом в `distributors.json`.
- Параметры: `name`, `regLink`, `contacts` (tg, wa, vb).

### 4.2. Режимы контента
- **Путь `/test` (Холодный):** Отображает `genericText` из базы рекомендаций (без названий брендов).
- **Путь `/checkpoint` (Клубный):** Отображает `productText` (конкретные продукты Coral Club).

## 5. Логика и Состояние (State Management)
- **LocalStorage:** Ключ `health_test_state`. Сохраняет текущий индекс вопроса и массив выбранных ответов.
- **Debug Mode:** При наличии `?debug=true` в URL, если в LocalStorage есть данные, приложение сразу перескакивает на экран результатов.
- **Подсчет баллов:**
    - 0–10: "Системное восстановление" (Критический уровень)
    - 11–22: "Coral Detox Plus" (Средний уровень)
    - 23–33: "Минимальная профилактика" (Хорошее состояние)

## 6. Требования к UI (Mobile First)
- **Один вопрос — один экран:** Центрирование по вертикали и горизонтали.
- **Progress Bar:** Сверху (Вопрос X из Y).
- **Кнопки:** Высота не менее 56px, удобные для нажатия пальцем.
- **Результаты:** Простой текстовый список (без аккордеонов).
- **QR-код:** Вывод строго в тег `<img>`. Позволяет сохранить результат через Long Tap (удерживание пальцем).

## 7. Формат данных в QR-коде (Текстовый/YAML)
QR-код должен содержать:
- Имя, Возраст, Вес, Запрос.
- Итоговый балл и Уровень нагрузки.
- Список ID вопросов и ответов (для быстрого восстановления анамнеза консультантом).
- Список сработавших триггеров (TAGS).

## 8. Алгоритм реализации для ИИ-ассистента
1. Реализуй загрузку JSON через `fetch`.
2. Настрой роутинг на основе `window.location.pathname`.
3. Создай систему рендеринга экранов (Welcome -> Questions -> Results).
4. Интегрируй `localStorage` для сохранения прогресса.
5. Напиши логику генерации текста для QR и его конвертации в `<img>`.
6. Стилизуй интерфейс согласно Mobile-first принципам.